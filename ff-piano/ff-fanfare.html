<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Final Fantasy Piano</title>
    </head>
    <body>
        <div style="font-family: sans-serif; font-size: 12px; margin-left: 30px;">
            Final Fantasy (NES) Victory Fanfare (Nobuo Uematsu)
            <a href="https://www.youtube.com/watch?v=1IWAShKc2RI" target="_blank"><img src="youtube.png">Listen on YouTube</a>
        </div>        
        <canvas width="800" height="460" id="myCanvas"></canvas>

        <script src="vexflow-min.js"></script>
        <script src="vexflow-setup.js"></script>
        <script>

         var canvas = document.getElementById("myCanvas");
         var renderer = new Vex.Flow.Renderer(canvas, Vex.Flow.Renderer.Backends.CANVAS);
         var ctx = renderer.getContext();


         function page2() {
             // FIRST LINE
             // Initialize Staves
             var staveTreble1 = new Vex.Flow.Stave(10, stave_y, stave_length + stave_additional_length);
             var staveBass1 = new Vex.Flow.Stave(10, stave_y + stave_inner_space, stave_length + stave_additional_length);
             
             staveTreble1.addClef("treble").addKeySignature("A").addTimeSignature("4/4").setContext(ctx).draw();
             staveBass1.addClef("bass").addKeySignature("A").addTimeSignature("4/4").setContext(ctx).draw();

             var voiceTreble1 = new Vex.Flow.Voice({num_beats:4, beat_value: 4, resolution:Vex.Flow.RESOLUTION});
             var voiceBass1 = new Vex.Flow.Voice({num_beats:4, beat_value: 4, resolution:Vex.Flow.RESOLUTION});


             // ACCIDENTAL
             // new Vex.Flow.StaveNote({ keys: ['d/5'], duration: '4'}).addAccidental(0, new Vex.Flow.Accidental("#")),

             var bar = new Vex.Flow.BarNote();

             var notesBassMain1 = [
                 note(['b/4'], '4r'),
                 note(['e/3'], 8, true),
                 note(['g/3'], 8, true),
                 note(['b/3'], 8, true),
                 note(['e/3'], 8, true),
                 note(['g/3'], 8, true),
                 note(['b/3'], 8, true),
                 note(['b/4'], '4r'),
                 
                 // note(['e/4'], 8, true),
                 // note(['g/4'], 8, true),
                 // note(['b/4'], 8, true),
             ];
             // var beamBassMain1 = new Vex.Flow.Beam(notesBassMain1);
             var tupletBassMain1_1 = new Vex.Flow.Tuplet(notesBassMain1.slice(1, 4));
             var tupletBassMain1_2 = new Vex.Flow.Tuplet(notesBassMain1.slice(4, 7));
             // var tupletBassMain1_3 = new Vex.Flow.Tuplet(notesBassMain1.slice(7, 10));
             // var tupletBassMain1_4 = new Vex.Flow.Tuplet(notesBassMain1.slice(9, 12));

             var beamBassMain1_1 = new Vex.Flow.Beam(notesBassMain1.slice(1, 4));
             var beamBassMain1_2 = new Vex.Flow.Beam(notesBassMain1.slice(4, 7));
             // var beamBassMain1_3 = new Vex.Flow.Beam(notesBassMain1.slice(7, 10));
             // var beamBassMain1_4 = new Vex.Flow.Beam(notesBassMain1.slice(9, 12));
             
             var notesBass1 = notesBassMain1;


             // TREBLE
             var notesTrebleMain1 = [
                 note(['b/4'], '2r'),
                 note(['b/4'], '4r'),
                 
                 note(['e/4'], '8'),
                 note(['g/4'], '8'),
                 note(['b/4'], '8'),
             ];

             var tupletTrebleMain1_1 = new Vex.Flow.Tuplet(notesTrebleMain1.slice(2, 5));
             var beamTrebleMain1_1 = new Vex.Flow.Beam(notesTrebleMain1.slice(2, 5));
             
             var notesTreble1 = notesTrebleMain1;

             voiceTreble1.addTickables(notesTreble1);
             voiceBass1.addTickables(notesBass1);

             var formatter = new Vex.Flow.Formatter();
             formatter.format([voiceTreble1, voiceBass1], stave_length);

             var max_x1 = Math.max(staveTreble1.getNoteStartX(), staveBass1.getNoteStartX());
             staveTreble1.setNoteStartX(max_x1);
             staveBass1.setNoteStartX(max_x1);
             
             voiceTreble1.draw(ctx, staveTreble1);
             voiceBass1.draw(ctx, staveBass1);

             // DRAW BEAMS
             
             beamBassMain1_1.setContext(ctx).draw();
             beamBassMain1_2.setContext(ctx).draw();
             // beamBassMain1_3.setContext(ctx).draw();
             // beamBassMain1_4.setContext(ctx).draw();
             

             beamTrebleMain1_1.setContext(ctx).draw();

             // beamTrebleMain1_1.setContext(ctx).draw();

             tupletBassMain1_1.setContext(ctx).draw();
             tupletBassMain1_2.setContext(ctx).draw();
             // tupletBassMain1_3.setContext(ctx).draw();
             // tupletBassMain1_4.setContext(ctx).draw();

             tupletTrebleMain1_1.setContext(ctx).draw();

             /////////////////////////////////////
             // SECOND LINE
             stave_y += line_space;

             // Initialize Staves
             var staveTreble1 = new Vex.Flow.Stave(10, stave_y, stave_length + stave_additional_length);
             var staveBass1 = new Vex.Flow.Stave(10, stave_y + stave_inner_space, stave_length + stave_additional_length);
             
             staveTreble1.addClef("treble").addKeySignature("A").addTimeSignature("4/4").setContext(ctx).draw();
             staveBass1.addClef("bass").addKeySignature("A").addTimeSignature("4/4").setContext(ctx).draw();

             var voiceTreble1 = new Vex.Flow.Voice({num_beats:8, beat_value: 4, resolution:Vex.Flow.RESOLUTION});
             var voiceBass1 = new Vex.Flow.Voice({num_beats:8, beat_value: 4, resolution:Vex.Flow.RESOLUTION});


             // ACCIDENTAL
             // new Vex.Flow.StaveNote({ keys: ['d/5'], duration: '4'}).addAccidental(0, new Vex.Flow.Accidental("#")),

             var bar = new Vex.Flow.BarNote();

             // SECOND LINE, LEFT
             var notesBassMain1 = [
                 note(['e/4'], 4, true),
                 note(['b/3'], 4, true),
                 note(['g/3'], 4, true),
                 note(['e/3'], 4, true),
                 note(['g/3'], 4, true).addAccidental(0, new Vex.Flow.Accidental("n")),
             ];
             var tupletBassMain1_1 = new Vex.Flow.Tuplet(notesBassMain1.slice(0, 3));


             // SECOND LINE, RIGHT
             var notesBassMain2 = [
                 note(['a/3'], 4, true),
                 note(['e/3'], '8d', true).addDotToAll(), // how to skip 1/16?
                 note(['e/3'], 16, true),
                 note(['e/3'], 2, true),
             ];             

             var notesBass1 = notesBassMain1.concat(bar).concat(notesBassMain2);


             // TREBLE
             // SECOND LINE, LEFT
             var notesTrebleMain1 = [
                 note(['g/4', 'b/4', 'e/5'], 4),
                 note(['g/4', 'b/4', 'e/5'], 4),
                 note(['g/4', 'b/4', 'e/5'], 4),
                 note(['g/4', 'b/4', 'e/5'], 4),
                 note(['e/4', 'c/5'], 4).addAccidental(1, new Vex.Flow.Accidental("n")),
             ];

             var tupletTrebleMain1 = new Vex.Flow.Tuplet(notesTrebleMain1.slice(0, 3));

             // SECOND LINE, RIGHT             
             var notesTrebleMain2 = [
                 note(['f/4', 'd/5'], 4),
                 note(['g/4', 'e/5'], '8d').addDotToAll(), // how to skip 1/16?
                 note(['f/4', 'd/5'], 16),
                 note(['g/4', 'e/5'], 2),
             ];
             // var beamTrebleMain1_1 = new Vex.Flow.Beam(notesTrebleMain2.slice(1, 3));
                 
             var notesTreble1 = notesTrebleMain1.concat(bar).concat(notesTrebleMain2);
             

             voiceTreble1.addTickables(notesTreble1);
             voiceBass1.addTickables(notesBass1);

             var formatter = new Vex.Flow.Formatter();
             formatter.format([voiceTreble1, voiceBass1], stave_length);

             var max_x1 = Math.max(staveTreble1.getNoteStartX(), staveBass1.getNoteStartX());
             staveTreble1.setNoteStartX(max_x1);
             staveBass1.setNoteStartX(max_x1);
             
             voiceTreble1.draw(ctx, staveTreble1);
             voiceBass1.draw(ctx, staveBass1);

             // DRAW BEAMS

             
             
             // beamTrebleMain1_1.setContext(ctx).draw();
             tupletTrebleMain1.setContext(ctx).draw();
             tupletBassMain1_1.setContext(ctx).draw();

         }





         page2();
         
         function prev() {
             console.log("previous page");
         }

         function next() {
             console.log("next page");
         }
         
        </script><br><br>

        <div style="margin-left: 400px;">
            <a href="ff-fanfare2.html"><img src="next.jpg" onclick="prev();"></a>
        </div>
        
        Rendered with VexFlow
    </body>
</html>
